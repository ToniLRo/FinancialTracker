<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">

</head>
<div class="content">
    <div class="header">
        <div class="title">
            <h2>My Wallets</h2>
        </div>
    </div>
    <div class="content text-white">
        <div class="actions">
            <div class="action-button">
                <button class="button-27" role="button" title="Add Card" (click)="openAddForm()">
                    <i class="bi bi-plus-circle" style="color: white; font-size: 25px;"></i>
                </button>
                <div class="button-description"  style="text-align: center;">
                    Add Card
                </div>
            </div>
            <div class="action-button">
                <button class="button-27" role="button" title="Edit Card" [disabled]="!selectedCard" (click)="openEditForm(selectedCard!)">
                        <i class="bi bi-pencil-square" style="color: white; font-size: 25px;"></i>
                </button>
                <div class="button-description"  style="text-align: center;">
                    Edit Card
                </div>
            </div>
            <div class="action-button">
                <button class="button-27" role="button" title="Delete Card" [disabled]="!selectedCard" (click)="deleteCard(selectedCard!.id)">
                    <i class="bi bi-trash" style="color: white; font-size: 25px;"></i>
                </button>
                <div class="button-description"  style="text-align: center;">
                    Delete Card
                </div>
            </div>
            <div class="action-button">
                <button title="Show Details" class="button-27" role="button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
                        <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"/>
                        <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7"/>
                    </svg>
                </button>
                <div class="button-description"  style="text-align: center;">
                    Show Details
                </div>
            </div>
            <div class="action-button">
                <button class="button-27" role="button" title="Freeze/Unfreeze" [disabled]="!selectedCard" (click)="freezeCard(selectedCard!)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-snow" viewBox="0 0 16 16">
                        <path d="M8 16a.5.5 0 0 1-.5-.5v-1.293l-.646.647a.5.5 0 0 1-.707-.708L7.5 12.793V8.866l-3.4 1.963-.496 1.85a.5.5 0 1 1-.966-.26l.237-.882-1.12.646a.5.5 0 0 1-.5-.866l1.12-.646-.884-.237a.5.5 0 1 1 .26-.966l1.848.495L7 8 3.6 6.037l-1.85.495a.5.5 0 0 1-.258-.966l.883-.237-1.12-.646a.5.5 0 1 1 .5-.866l1.12.646-.237-.883a.5.5 0 1 1 .966-.258l.495 1.849L7.5 7.134V3.207L6.147 1.854a.5.5 0 1 1 .707-.708l.646.647V.5a.5.5 0 1 1 1 0v1.293l.647-.647a.5.5 0 1 1 .707.708L8.5 3.207v3.927l3.4-1.963.496-1.85a.5.5 0 1 1 .966.26l-.236.882 1.12-.646a.5.5 0 0 1 .5.866l-1.12.646.883.237a.5.5 0 1 1-.26.966l-1.848-.495L9 8l3.4 1.963 1.849-.495a.5.5 0 0 1 .259.966l-.883.237 1.12.646a.5.5 0 0 1-.5.866l-1.12-.646.236.883a.5.5 0 1 1-.966.258l-.495-1.849-3.4-1.963v3.927l1.353 1.353a.5.5 0 0 1-.707.708l-.647-.647V15.5a.5.5 0 0 1-.5.5z"/>
                    </svg>                </button>
                <div class="button-description"  style="text-align: center;">
                    Freeze
                </div>
            </div>
            <div class="action-button">
                <button title="Add Transaction/Transfer" class="button-27" role="button" [disabled]="!selectedCard" (click)="openTransactionForm(selectedCard!)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" fill="currentColor" class="bi bi-plus" viewBox="0 0 16 16">
                        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"/>
                    </svg>
                </button>
                <div class="button-description">
                    Add Transaction/Transfer
                </div>
            </div>
            <div class="action-button">
                <button title="Withdraw" class="button-27" role="button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-reply-all-fill" viewBox="0 0 16 16">
                        <path d="M8.021 11.9 3.453 8.62a.72.72 0 0 1 0-1.238L8.021 4.1a.716.716 0 0 1 1.079.619V6c1.5 0 6 0 7 8-2.5-4.5-7-4-7-4v1.281c0 .56-.606.898-1.079.62z"/>
                        <path d="M5.232 4.293a.5.5 0 0 1-.106.7L1.114 7.945l-.042.028a.147.147 0 0 0 0 .252l.042.028 4.012 2.954a.5.5 0 1 1-.593.805L.539 9.073a1.147 1.147 0 0 1 0-1.946l3.994-2.94a.5.5 0 0 1 .699.106"/>
                    </svg>
                </button>
                <div class="button-description"  style="text-align: center;">
                    Withdraw
                </div>
            </div>
            <div class="action-button">
                    <button title="Deposit" class="button-27" role="button">
                        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-cash-stack" viewBox="0 0 16 16">
                            <path d="M1 3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1zm7 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4"/>
                            <path d="M0 5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1zm3 0a2 2 0 0 1-2 2v4a2 2 0 0 1 2 2h10a2 2 0 0 1 2-2V7a2 2 0 0 1-2-2z"/>
                        </svg>
                    </button>
                <div class="button-description"  style="text-align: center;">
                    Deposit
                </div>
            </div>
        </div>
        <div class="mycards">
            <div class="slide-container swiper">
                <h5 style="text-align: center;">My Cards</h5>
                <div class="slide-content">
                    <div class="card-wrapper swiper-wrapper">
                        <div *ngFor="let card of cards" class="card swiper-slide" [class.selected]="card === selectedCard" (click)="selectCard(card)">
                            <div class="card-inner">
                                <div class="card-front">  
                                    <div class="card-bg"></div>
                                    <div class="card-glow"></div>
                                    <svg
                                        width="72"
                                        height="24"
                                        viewBox="0 0 72 24"
                                        fill="none"
                                        xmlns="http://www.w3.org/2000/svg"
                                        class="logo"
                                    >
                                        <path
                                        fill-rule="evenodd"
                                        clip-rule="evenodd"
                                        d="M52.3973 1.01093L51.5588 5.99054C49.0448 4.56717 43.3231 4.23041 43.3231 6.85138C43.3231 7.89285 44.6177 8.60913 46.178 9.47241C48.5444 10.7817 51.5221 12.4291 51.5221 16.062C51.5221 21.8665 45.4731 24 41.4645 24C37.4558 24 34.8325 22.6901 34.8325 22.6901L35.7065 17.4848C38.1115 19.4688 45.4001 20.032 45.4001 16.8863C45.4001 15.5645 43.9656 14.785 42.3019 13.8811C40.0061 12.6336 37.2742 11.1491 37.2742 7.67563C37.2742 1.30988 44.1978 0 47.1132 0C49.8102 0 52.3973 1.01093 52.3973 1.01093ZM66.6055 23.6006H72L67.2966 0.414276H62.5732C60.3923 0.414276 59.8612 2.14215 59.8612 2.14215L51.0996 23.6006H57.2234L58.4481 20.1566H65.9167L66.6055 23.6006ZM60.1406 15.399L63.2275 6.72235L64.9642 15.399H60.1406ZM14.7942 16.3622L20.3951 0.414917H26.7181L17.371 23.6012H11.2498L6.14551 3.45825C2.83215 1.41281 0 0.807495 0 0.807495L0.108643 0.414917H9.36816C11.9161 0.414917 12.1552 2.50314 12.1552 2.50314L14.1313 12.9281L14.132 12.9294L14.7942 16.3622ZM25.3376 23.6006H31.2126L34.8851 0.414917H29.0095L25.3376 23.6006Z"
                                        fill="white"
                                        />
                                    </svg>
                                    <div class="card-contactless">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="46" height="56">
                                        <path
                                            fill="none"
                                            stroke="#f9f9f9"
                                            stroke-width="6"
                                            stroke-linecap="round"
                                            d="m35,3a50,50 0 0,1 0,50M24,8.5a39,39 0 0,1 0,39M13.5,13.55a28.2,28.5
                                0 0,1 0,28.5M3,19a18,17 0 0,1 0,18"
                                        />
                                        </svg>
                                    </div>
                                    <div class="card-chip"></div>
                                    <div class="card-holder">{{ card.holder }}</div>
                                    <div class="card-number">{{ card.number }}</div>
                                    <div class="card-valid">{{ card.validThru }}</div>
                                    <div class="card-balance" style="position: absolute; bottom: 10px; right: 15px; font-size: 12px; color: #fff;">
                                        {{ card.balance | currency:'USD' }}
                                    </div>
                                    <div class="card-status" *ngIf="card.frozen" style="position: absolute; top: 10px; right: 15px; background: rgba(255,0,0,0.8); color: white; padding: 2px 8px; border-radius: 10px; font-size: 10px;">
                                        FROZEN
                                    </div>
                                </div>
                                <div class="card-back">
                                    <div class="card-signature">{{ card.holder }}</div>
                                    <div class="card-seccode">123</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="swiper-button-next swiper-navBtn"></div>
                <div class="swiper-button-prev swiper-navBtn"></div>
                <div class="swiper-pagination"></div>
            </div>
        </div>
        <div class="transactions-data text-white">
            <h2>Latest Transactions</h2>
            <h3>Today</h3>
            <div class="transactions">
                <details *ngFor="let transaction of getActiveCardTransactions()">
                    <summary>
                        <div>
                            <span [style.background-color]="getTransactionIconColor(transaction.type)">
                                <svg xmlns="http://www.w3.org/2000/svg" width="192" height="192" fill="currentColor" viewBox="0 0 256 256">
                                    <rect width="256" height="256" fill="none"></rect>
                                    <path d="M192,120h27.05573a8,8,0,0,0,7.15542-4.42229l18.40439-36.80878a8,8,0,0,0-3.18631-10.52366L192,40" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></path>
                                    <path d="M64,120H36.94427a8,8,0,0,1-7.15542-4.42229L11.38446,78.76893a8,8,0,0,1,3.18631-10.52366L64,40" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></path>
                                    <path d="M160,40a32,32,0,0,1-64,0H64V208a8,8,0,0,0,8,8H184a8,8,0,0,0,8-8V40Z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></path>
                                </svg>
                            </span>
                            <h3>
                                <strong>{{ transaction.description }}</strong>
                                <small>{{ transaction.type }}</small>
                            </h3>
                            <span [class.plus]="transaction.amount > 0" [class.minus]="transaction.amount < 0">
                                {{ transaction.amount > 0 ? '+' : '' }}{{ transaction.amount | currency:'USD' }}
                            </span>
                        </div>
                    </summary>
                    <div>
                        <dl>
                            <div>
                                <dt>Date</dt>
                                <dd>{{ transaction.date | date:'shortDate' }}</dd>
                            </div>
                            <div>
                                <dt>Card used</dt>
                                <dd>•••• {{ getActiveCard()?.number?.slice(-4) }}</dd>
                            </div>
                            <div>
                                <dt>Reference ID</dt>
                                <dd>{{ generateReferenceId() }}</dd>
                            </div>
                        </dl>
                    </div>
                </details>
                
                <!-- Mensaje cuando no hay transacciones -->
                <div *ngIf="!getActiveCardTransactions()?.length" class="no-transactions">
                    <p>No transactions found for this card.</p>
                </div>
            </div>
        </div>
</div>

  
<!-- Modal for Add/Edit Card -->
<div class="modal" *ngIf="showForm">
    <div class="modal-content">
      <h3>{{ isEdit ? 'Edit Card' : 'Add Card' }}</h3>
      <form (ngSubmit)="saveCard(selectedCard!)">
        <label>Card Holder</label>
        <input [(ngModel)]="selectedCard!.holder" name="holder" required>
        <label>Card Number</label>
        <input [(ngModel)]="selectedCard!.number" name="number" required maxlength="16">
        <label>Type</label>
        <select [(ngModel)]="selectedCard!.type" name="type" required>
          <option value="Credit">Credit</option>
          <option value="Debit">Debit</option>
          <option value="Cash">Cash</option>
        </select>
        <label>Balance</label>
        <input type="number" [(ngModel)]="selectedCard!.balance" name="balance" required>
        <label>Valid Thru</label>
        <input type="text" [(ngModel)]="selectedCard!.validThru" name="validThru" placeholder="MM/YY" required>
        <button type="submit" class="btn btn-success">{{ isEdit ? 'Save Changes' : 'Add Card' }}</button>
        <button type="button" class="btn btn-secondary" (click)="closeForm()">Cancel</button>
      </form>
    </div>
  </div>
  
  <!-- Modal for Add Transaction -->
  <div class="modal" *ngIf="showTransactionForm">
    <div class="modal-content">
      <h3>Add Transaction</h3>
      <form (ngSubmit)="saveTransaction()">
        <label>Date</label>
        <input type="date" [(ngModel)]="transactionForm.date" name="date" required>
        <label>Description</label>
        <input [(ngModel)]="transactionForm.description" name="description" required>
        <label>Amount</label>
        <input type="number" [(ngModel)]="transactionForm.amount" name="amount" required>
        <label>Type</label>
        <select [(ngModel)]="transactionForm.type" name="type" required>
          <option value="Food">Food</option>
          <option value="Transport">Transport</option>
          <option value="Shopping">Shopping</option>
          <option value="Entertainment">Entertainment</option>
          <option value="Income">Income</option>
          <option value="Gift">Gift</option>
        </select>
        <button type="submit" class="btn btn-success">Add</button>
        <button type="button" class="btn btn-secondary" (click)="closeTransactionForm()">Cancel</button>
      </form>
    </div>
  </div>